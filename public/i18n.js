const translations = {
    'zh-CN': {
        // Header
        'title': 'VPS å‰©ä½™ä»·å€¼è®¡ç®—å™¨',
        'subtitle': 'å®žæ—¶æ±‡çŽ‡ Â· ç²¾å‡†è®¡ç®—',

        // Input card
        'vps-info': 'VPS ä¿¡æ¯',
        'purchase-amount': 'è´­ä¹°é‡‘é¢',
        'currency-type': 'è´§å¸ç§ç±»',
        'payment-cycle': 'ä»˜æ¬¾å‘¨æœŸ',
        'today-rate': 'ä»Šæ—¥æ±‡çŽ‡',
        'rate-api-source': 'API: ExchangeRate-API',
        'current-date': 'å½“å‰æ—¥æœŸ',
        'expiry-date': 'åˆ°æœŸæ—¶é—´',
        'calculate-btn': 'è®¡ç®—å‰©ä½™ä»·å€¼',
        'input-placeholder': 'è¾“å…¥é‡‘é¢',
        'rate-loading': 'åŠ è½½ä¸­...',
        'refresh-rate-title': 'åˆ·æ–°æ±‡çŽ‡',
        'select-date': 'é€‰æ‹©æ—¥æœŸ',

        // Currency names
        'USD': 'USD - ç¾Žå…ƒ',
        'EUR': 'EUR - æ¬§å…ƒ',
        'GBP': 'GBP - è‹±é•‘',
        'CNY': 'CNY - äººæ°‘å¸',
        'JPY': 'JPY - æ—¥å…ƒ',
        'HKD': 'HKD - æ¸¯å¸',
        'SGD': 'SGD - æ–°åŠ å¡å…ƒ',
        'AUD': 'AUD - æ¾³å…ƒ',
        'CAD': 'CAD - åŠ å…ƒ',

        // Payment cycles
        'monthly': 'æœˆä»˜',
        'quarterly': 'å­£ä»˜',
        'semi-annually': 'åŠå¹´ä»˜',
        'annually': 'å¹´ä»˜',

        // Result card
        'result-title': 'è®¡ç®—ç»“æžœ',
        'copy-screenshot': 'ðŸ“‹ å¤åˆ¶æˆªå›¾',
        'download-screenshot': 'ðŸ’¾ ä¸‹è½½',
        'daily-cost': 'æ¯æ—¥æˆæœ¬',
        'remaining-value': 'å‰©ä½™ä»·å€¼',
        'remaining-days': 'å‰©ä½™å¤©æ•°',
        'multi-currency-value': 'å‰©ä½™ä»·å€¼ï¼ˆå¤šå¸ç§ï¼‰',
        'formula-title': 'è®¡ç®—å…¬å¼',

        // Formula
        'formula-remaining-days': 'å‰©ä½™å¤©æ•°',
        'formula-daily-cost': 'æ¯æ—¥æˆæœ¬',
        'formula-remaining-value': 'å‰©ä½™ä»·å€¼',
        'days-unit': 'å¤©',
        'per-day': '/å¤©',

        // Cycle names in formula
        'cycle-monthly': 'æœˆä»˜(30å¤©)',
        'cycle-quarterly': 'å­£ä»˜(90å¤©)',
        'cycle-semi-annually': 'åŠå¹´ä»˜(180å¤©)',
        'cycle-annually': 'å¹´ä»˜(365å¤©)',

        // Messages
        'msg-invalid-price': 'è¯·è¾“å…¥æœ‰æ•ˆçš„è´­ä¹°é‡‘é¢',
        'msg-select-current-date': 'è¯·é€‰æ‹©å½“å‰æ—¥æœŸ',
        'msg-select-expiry-date': 'è¯·é€‰æ‹©åˆ°æœŸæ—¶é—´',
        'msg-no-exchange-rate': 'æ— æ³•èŽ·å–æ±‡çŽ‡æ•°æ®ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥åŽé‡è¯•',
        'msg-expiry-after-current': 'åˆ°æœŸæ—¶é—´å¿…é¡»æ™šäºŽå½“å‰æ—¥æœŸ',
        'msg-calculate-first': 'è¯·å…ˆè®¡ç®—ç»“æžœ',
        'msg-screenshot-copied': 'âœ… æˆªå›¾å·²å¤åˆ¶åˆ°å‰ªè´´æ¿',
        'msg-clipboard-fallback': 'âš ï¸ å½“å‰æµè§ˆå™¨ä¸æ”¯æŒå¤åˆ¶å›¾ç‰‡åˆ°å‰ªè´´æ¿ï¼Œå·²è‡ªåŠ¨ä¸‹è½½',
        'msg-screenshot-failed': 'âš ï¸ æˆªå›¾å¤±è´¥: ',
        'msg-screenshot-downloaded': 'âœ… æˆªå›¾å·²ä¸‹è½½',
        'msg-rate-retry': 'é‡è¯•ä¸­',
        'msg-rate-failed': 'åŠ è½½å¤±è´¥ï¼Œç‚¹å‡»åˆ·æ–°',
        'updated-at': 'æ›´æ–°äºŽ',

        // Footer
        'footer-text': 'ðŸ’¡ ä½¿ç”¨å®žæ—¶æ±‡çŽ‡ API æä¾›å‡†ç¡®æ¢ç®—',

        // SEO
        'seo-title': 'VPS å‰©ä½™ä»·å€¼è®¡ç®—å™¨',
        'seo-description': 'VPS å‰©ä½™ä»·å€¼è®¡ç®—å™¨ - å®žæ—¶æ±‡çŽ‡æ¢ç®—ï¼Œç²¾å‡†è®¡ç®— VPS å‰©ä½™å¤©æ•°ä¸Žä»·å€¼ï¼Œæ”¯æŒå¤šå¸ç§æ˜¾ç¤º',
        'seo-keywords': 'VPS,è®¡ç®—å™¨,å‰©ä½™ä»·å€¼,æ±‡çŽ‡,æœåŠ¡å™¨,ä¸»æœº',

        // Language button
        'lang-toggle': 'ðŸŒ EN',
    },
    'en': {
        'title': 'VPS Remaining Value Calculator',
        'subtitle': 'Real-time Rates Â· Precise Calculation',

        'vps-info': 'VPS Information',
        'purchase-amount': 'Purchase Amount',
        'currency-type': 'Currency',
        'payment-cycle': 'Payment Cycle',
        'today-rate': 'Today\'s Rate',
        'rate-api-source': 'API: ExchangeRate-API',
        'current-date': 'Current Date',
        'expiry-date': 'Expiry Date',
        'calculate-btn': 'Calculate Remaining Value',
        'input-placeholder': 'Enter amount',
        'rate-loading': 'Loading...',
        'refresh-rate-title': 'Refresh rate',
        'select-date': 'Select date',

        'USD': 'USD - US Dollar',
        'EUR': 'EUR - Euro',
        'GBP': 'GBP - British Pound',
        'CNY': 'CNY - Chinese Yuan',
        'JPY': 'JPY - Japanese Yen',
        'HKD': 'HKD - Hong Kong Dollar',
        'SGD': 'SGD - Singapore Dollar',
        'AUD': 'AUD - Australian Dollar',
        'CAD': 'CAD - Canadian Dollar',

        'monthly': 'Monthly',
        'quarterly': 'Quarterly',
        'semi-annually': 'Semi-Annually',
        'annually': 'Annually',

        'result-title': 'Results',
        'copy-screenshot': 'ðŸ“‹ Copy Screenshot',
        'download-screenshot': 'ðŸ’¾ Download',
        'daily-cost': 'Daily Cost',
        'remaining-value': 'Remaining Value',
        'remaining-days': 'Remaining Days',
        'multi-currency-value': 'Remaining Value (Multi-Currency)',
        'formula-title': 'Formula',

        'formula-remaining-days': 'Remaining Days',
        'formula-daily-cost': 'Daily Cost',
        'formula-remaining-value': 'Remaining Value',
        'days-unit': 'days',
        'per-day': '/day',

        'cycle-monthly': 'Monthly (30 days)',
        'cycle-quarterly': 'Quarterly (90 days)',
        'cycle-semi-annually': 'Semi-Annual (180 days)',
        'cycle-annually': 'Annual (365 days)',

        'msg-invalid-price': 'Please enter a valid purchase amount',
        'msg-select-current-date': 'Please select the current date',
        'msg-select-expiry-date': 'Please select an expiry date',
        'msg-no-exchange-rate': 'Unable to fetch exchange rates. Please check your network and try again.',
        'msg-expiry-after-current': 'Expiry date must be after the current date',
        'msg-calculate-first': 'Please calculate first',
        'msg-screenshot-copied': 'âœ… Screenshot copied to clipboard',
        'msg-clipboard-fallback': 'âš ï¸ Your browser does not support copying images. Downloaded instead.',
        'msg-screenshot-failed': 'âš ï¸ Screenshot failed: ',
        'msg-screenshot-downloaded': 'âœ… Screenshot downloaded',
        'msg-rate-retry': 'Retrying',
        'msg-rate-failed': 'Failed to load. Click to refresh.',
        'updated-at': 'Updated at',

        'footer-text': 'ðŸ’¡ Powered by real-time exchange rate API',

        'seo-title': 'VPS Remaining Value Calculator',
        'seo-description': 'VPS Remaining Value Calculator - Real-time exchange rates, accurately calculate remaining days and value of your VPS, multi-currency support',
        'seo-keywords': 'VPS,calculator,remaining value,exchange rate,server,hosting',

        'lang-toggle': 'ðŸŒ ä¸­æ–‡',
    }
};

let currentLang = 'zh-CN';

function detectLang() {
    const stored = localStorage.getItem('lang');
    if (stored && translations[stored]) return stored;
    const nav = navigator.language || navigator.userLanguage || '';
    return nav.startsWith('zh') ? 'zh-CN' : 'en';
}

function getLang() {
    return currentLang;
}

function setLang(lang) {
    if (!translations[lang]) return;
    currentLang = lang;
    localStorage.setItem('lang', lang);
    document.documentElement.lang = lang;
}

function t(key) {
    const pack = translations[currentLang] || translations['zh-CN'];
    return pack[key] !== undefined ? pack[key] : key;
}

function applyTranslations() {
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        const target = el.getAttribute('data-i18n-target');
        if (target === 'placeholder') {
            el.placeholder = t(key);
        } else if (target === 'title') {
            el.title = t(key);
        } else {
            el.textContent = t(key);
        }
    });

    // Update select options that have data-i18n-option
    document.querySelectorAll('option[data-i18n]').forEach(opt => {
        opt.textContent = t(opt.getAttribute('data-i18n'));
    });

    // Update lang toggle button text
    const langBtn = document.getElementById('langToggleBtn');
    if (langBtn) langBtn.textContent = t('lang-toggle');

    // Update SEO meta tags
    document.title = t('seo-title');
    const setMeta = (sel, val) => { const el = document.querySelector(sel); if (el) el.setAttribute('content', val); };
    setMeta('meta[name="description"]', t('seo-description'));
    setMeta('meta[name="keywords"]', t('seo-keywords'));
    setMeta('meta[property="og:title"]', t('seo-title'));
    setMeta('meta[property="og:description"]', t('seo-description'));
    setMeta('meta[name="twitter:title"]', t('seo-title'));
    setMeta('meta[name="twitter:description"]', t('seo-description'));

    // Update JSON-LD structured data
    const jsonLd = document.querySelector('script[type="application/ld+json"]');
    if (jsonLd) {
        try {
            const data = JSON.parse(jsonLd.textContent);
            data.name = t('seo-title');
            data.description = t('seo-description');
            jsonLd.textContent = JSON.stringify(data, null, 4);
        } catch (e) {}
    }
}

// Initialize language on load
currentLang = detectLang();
